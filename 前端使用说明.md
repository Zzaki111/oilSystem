# 石油生产数据预处理系统 - Web前端使用说明

## 🌟 系统简介

这是一个专业的石油生产数据预处理系统，提供美观易用的Web界面，支持4个核心业务功能。

## 🚀 快速启动

### 1. 启动服务

```bash
cd /Users/zzaki/workspace_oil/oilSystem/backend
python app.py
```

服务将运行在：**http://localhost:5001**

### 2. 访问系统

在浏览器中打开：http://localhost:5001

## 📋 功能模块

### 第一业务界面：对比A2表与SEC表

**功能说明：**
- 对比上年度A2数据表与SEC数据表
- 识别参评井和非参评井
- 生成油井单元属性表

**操作步骤：**
1. 上传上年度A2数据表（.xlsx或.xls格式）
2. 上传上年度SEC数据表（.xlsx或.xls格式）
3. 输入年月（6位数字，如202409）
4. 点击"🚀 开始对比"按钮
5. 等待处理完成，查看统计结果
6. 点击下载按钮获取结果文件

**输出结果：**
- 总井数统计
- 参评井数统计
- 非参评井数统计
- 油井单元属性表Excel文件

---

### 第二业务界面：对比本年度与上年度A2表

**功能说明：**
- 对比两年度的A2数据表
- 识别注销井（上年度有，本年度没有）
- 识别新投井（本年度有，上年度没有）
- 识别单元归属变化井

**操作步骤：**
1. 上传上年度A2数据表
2. 上传本年度A2数据表
3. 输入年份（4位数字，如2025）
4. 点击"🚀 开始对比"按钮
5. 查看统计结果和下载文件

**输出结果：**
- 注销井统计和明细表
- 新投井统计和明细表
- 单元变化井统计和明细表

---

### 第三业务界面：生成本年度SEC数据表

**功能说明：**
- 根据单元变化、老区新井、扩边井等信息
- 生成本年度SEC数据表

**操作步骤：**
1. 上传上年度SEC数据表（必填）
2. 上传单元变化表（可选）
3. 上传老区新井表（可选）
4. 上传扩边/PUD转PDP/PDNP表（可选）
5. 输入本年度年份（4位数字）
6. 输入本年度年月（6位数字）
7. 点击"🚀 生成SEC数据表"按钮

**注意：** 此功能需要根据实际业务需求调用后端API。

---

### 第四业务界面：生成评估数据表

**功能说明：**
- 生成常规油和页岩油的评估数据表
- 支持历史数据调整
- 支持新井数据添加

**评估类型：**
1. **常规油评估**：按SEC单元汇总生成连续月份数据
2. **页岩油评估**：按单井生成连续月份数据

**操作步骤：**
1. 选择评估类型（常规油或页岩油）
2. 点击"🚀 生成评估数据表"按钮
3. 根据提示调用相应的API接口

**注意：** 此功能需要配合历史评估数据、本年度A2表等数据使用。

---

## 🎨 界面特色

### 1. 美观的设计
- 渐变色背景和卡片式布局
- 清晰的视觉层级
- 响应式设计，支持不同屏幕尺寸

### 2. 友好的交互
- 实时进度提示
- 加载动画显示
- 成功/错误消息通知
- 文件格式验证
- 输入格式提示

### 3. 数据可视化
- 统计卡片展示关键指标
- 渐变色彩突出重要数据
- 悬停效果增强交互体验

### 4. 便捷的操作
- 拖拽或点击上传文件
- 一键清空表单
- 直接下载结果文件
- 模块化的功能分区

---

## 📊 数据格式要求

### A2数据表字段（示例）
- 井号
- 大油田
- 单元
- 年月（6位数字，如202409）
- 投产日期
- 生产天数
- 月产液量
- 月产油量
- 等...

### SEC数据表字段（示例）
- 井号
- 评估油田
- 评估单元
- 投产年月
- 地质储量
- 等...

**注意：** 请确保上传的Excel文件格式正确，字段名称与系统要求一致。

---

## 🔧 技术架构

- **前端框架：** 原生HTML + CSS + JavaScript
- **后端框架：** Flask 2.3+
- **数据处理：** Pandas 2.0+
- **文件格式：** Excel (.xlsx, .xls)
- **API风格：** RESTful API

---

## 📝 注意事项

1. **文件格式：** 只支持.xlsx和.xls格式的Excel文件
2. **文件大小：** 建议单个文件不超过50MB
3. **年月格式：** 
   - 6位数字：YYYYMM（如202409）
   - 4位数字：YYYY（如2025）
4. **网络连接：** 确保浏览器能访问本地服务器
5. **浏览器兼容：** 推荐使用Chrome、Edge、Firefox等现代浏览器

---

## 🆘 常见问题

### Q1: 上传文件后没有反应？
**A:** 检查文件格式是否正确，确保是.xlsx或.xls文件，且文件未损坏。

### Q2: 提示"请选择文件"错误？
**A:** 确保已选择所有必填的文件，查看表单中哪些是必填项。

### Q3: 年月格式错误？
**A:** 
- 6位年月格式：YYYYMM（例如：202409表示2024年9月）
- 4位年份格式：YYYY（例如：2025）

### Q4: 处理时间过长？
**A:** 大文件处理需要时间，请耐心等待。如果超过5分钟仍无响应，可刷新页面重试。

### Q5: 如何查看处理结果？
**A:** 处理完成后，页面会显示统计卡片和下载按钮，点击下载按钮即可获取结果文件。

---

## 🔄 API接口说明

系统提供以下主要API接口：

1. **文件上传：** `POST /api/upload`
2. **业务1-对比：** `POST /api/business1/compare`
3. **业务1-树形结构：** `POST /api/business1/tree`
4. **业务2-对比：** `POST /api/business2/compare`
5. **业务3-生成SEC：** `POST /api/business3/generate`
6. **业务4-常规油：** `POST /api/business4/conventional`
7. **业务4-页岩油：** `POST /api/business4/shale`
8. **文件下载：** `GET /api/download/<filename>`

详细API文档请参考 `API使用文档.md`

---

## 📞 技术支持

如有问题或建议，请联系系统管理员。

**系统版本：** v1.0  
**最后更新：** 2026-01-10
