# 上市储量价值评估石油生产数据预处理系统使用说明书

## 系统概述
本系统是一个专门用于石油生产数据预处理的系统，主要功能是根据多种基础数据表进行处理，生成符合上市储量价值评估要求的评估数据表。系统包含四个核心业务界面，每个界面针对不同的数据处理需求。

## 系统架构
- **后端**：Python + Flask + Pandas + openpyxl
- **前端**：HTML + CSS + JavaScript
- **数据处理**：Excel文件读写和数据对比分析

## 四个业务界面详解

### 第一业务界面：A2与SEC对比
**功能描述**：对比上年度A2表与SEC表，生成油井单元属性表。

**输入数据**：
- 上年度A2数据表
- 上年度SEC数据表

**处理流程**：
1. 对比两表中的井号
2. 识别差异井（A2有但SEC无，或SEC有但A2无）
3. 生成油井单元属性表，包含井号、大油田、单元、井别、井型等属性

**输出结果**：油井单元属性表

### 第二业务界面：年度A2对比
**功能描述**：对比本年度与上年度A2表，识别注销井、新投井、归属变化井。

**输入数据**：
- 上年度A2数据表
- 本年度A2数据表

**处理流程**：
1. 对比两年度A2表中的井号
2. 识别注销井（上年有本年无）
3. 识别新投井（本年有上年无）
4. 识别归属变化井（相同井号但属性变化）

**输出结果**：井号变化统计表

### 第三业务界面：生成SEC数据表
**功能描述**：根据单元变化、老区新井、扩边/PUD转PDP/PDNP井等信息，生成本年度SEC数据表。

**输入数据**：
- 上年度SEC数据表
- 单元变化表（可选）
- 老区新井表（可选）
- 扩边/PUD转PDP/PDNP表（可选）

**处理流程**：
1. 调整SEC单元分配：根据单元变化表调整井的SEC单元归属
2. 添加老区新井：将老区新井表中的井加入SEC表
3. 添加PUD转PDP/PDNP井：将转换井加入SEC表

**输出结果**：本年度SEC数据表

### 第四业务界面：生成评估数据表
**功能描述**：生成常规油和页岩油的评估数据表，包含两个子页面。

#### 4.1 常规油评估数据表
**输入数据**：
- 上年度常规油评估数据表
- 年度油井SEC单元变化表
- 油井历史生产数据
- 扩边/PUD转PDP/PDNP数据表
- 老区新井数据表
- 上年度SEC数据表
- 本年度SEC数据表
- A2数据表（12个月）

**处理流程**：
1. **调整历史数据**：基于上年度评估数据和SEC单元变化，调整历史数据
2. **加入新增井**：添加扩边/PUD转PDP/PDNP井和老区新井
3. **更新年度数据**：更新老井的年度生产数据

#### 4.2 页岩油评估数据表
**输入数据**：
- 上年度页岩油评估数据表
- 扩边/PUD转PDP/PDNP数据表
- A2数据表（12个月）

**处理流程**：
- 基于上年度页岩油评估数据，结合扩边/PUD井和A2数据，更新年度数据

**注意事项**：
- 常规油和页岩油分别处理，互不影响
- 数据处理过程中考虑了大规模数据的效率优化

## 数据表格式要求

### A2数据表
必须包含字段：井号、大油田、单元、年月、月产油量(t)、月产液量(t)等

### SEC数据表
必须包含字段：井号、大油田、单元、SEC油田、SEC单元、是否参评、页岩油/常规等

### 评估数据表
输出格式：油气田、评估单元、生产时间年、生产时间月、油产量、液产量、油井开井数等

### 单元变化表
包含字段：井号、上年度SEC油田、本年度SEC油田、上年度SEC单元、本年度SEC单元等

## 系统特色

### 性能优化
- 针对大规模数据（单月约10万条，12个月约120万条）进行了性能优化
- 使用高效的Pandas数据处理技术
- 内存管理优化，避免大数据处理时的内存溢出

### 专业设计
- 界面设计符合国企风格，简洁专业
- 支持多种数据格式和复杂的数据处理流程
- 完整的数据验证和错误处理机制

### 功能完整
- 四个业务界面覆盖完整的石油生产数据处理流程
- 支持常规油和页岩油的分别处理
- 提供详细的操作指导和结果反馈

## 使用指南

1. **准备数据**：按照各业务界面要求准备相应的Excel格式数据文件
2. **选择业务界面**：根据处理需求选择对应的业务界面
3. **上传文件**：按提示上传所需的数据文件
4. **执行处理**：点击相应按钮执行数据处理
5. **查看结果**：处理完成后查看结果统计并下载输出文件

## 技术支持

本系统已通过全面测试，所有功能模块均正常运行。如遇问题，请参考各业务界面的详细说明文档。