# 示例数据使用说明

## ✅ 问题已修复

**问题：** A2表缺少必需字段: ['月产油量']

**原因：** 字段名称应该是 **"月产油量(t)"** 而不是 "月产油量"，系统要求字段名带单位后缀。

**解决方案：**
1. 修复了数据导入验证逻辑（支持字段名兼容）
2. 更新了示例数据生成脚本
3. 重新生成了正确的示例数据文件

---

## 📁 已生成的示例数据文件

位置：`data/input/`

| 文件名 | 用途 | 说明 |
|--------|------|------|
| `a2-202409_sample.xlsx` | 第一业务界面 - A2表 | 100条井数据，202409年月 |
| `SEC数据表-202409_sample.xlsx` | 第一业务界面 - SEC表 | 90条井数据，含参评信息 |
| `a2-202409_上年度.xlsx` | 第二业务界面 - 上年度A2 | 80条井数据，202409年月 |
| `a2-202509_本年度.xlsx` | 第二业务界面 - 本年度A2 | 95条井数据，202509年月 |

---

## 📊 正确的A2表字段格式

### 必需字段（带单位后缀）

```
井号
大油田
单元
年月
月产油量(t)      ← 注意：必须包含 "(t)" 单位后缀
```

### 完整字段列表

```
井号
大油田
单元
井别
井型
油藏类型
当前层位
关闭层位
年月
投产日期
生产天数(d)
月产液量(t)
月产油量(t)       ← 必需字段
月产水量(m3)
月产气量(10^4m3)
核实月产液量(t)
核实月产油量(t)
核实月产水量(m3)
核实月产气量(10^4m3)
```

---

## 🚀 快速测试

### 测试第一业务界面

1. 访问 http://localhost:5001
2. 点击"第一业务界面"
3. 上传文件：
   - A2表：`data/input/a2-202409_sample.xlsx`
   - SEC表：`data/input/SEC数据表-202409_sample.xlsx`
4. 输入年月：`202409`
5. 点击"🚀 开始对比"

**预期结果：**
- 总井数：100
- 参评井数：90
- 非参评井数：10

---

### 测试第二业务界面

1. 点击"第二业务界面"
2. 上传文件：
   - 上年度A2表：`data/input/a2-202409_上年度.xlsx`
   - 本年度A2表：`data/input/a2-202509_本年度.xlsx`
3. 输入年份：`2025`
4. 点击"🚀 开始对比"

**预期结果：**
- 注销井数：5个（W001-W005）
- 新投井数：20个（W081-W100）
- 单元变化井数：若干个

---

## 🔧 重新生成示例数据

如果需要重新生成示例数据，运行：

```bash
cd /Users/zzaki/workspace_oil/oilSystem
python generate_sample_data.py
```

这将在 `data/input/` 目录下生成4个示例Excel文件。

---

## 💡 自定义数据格式要求

如果您要使用自己的Excel文件：

### A2数据表要求

1. **文件格式**：.xlsx 或 .xls
2. **必需字段**：
   - 井号（文本）
   - 大油田（文本）
   - 单元（文本）
   - 年月（整数，6位，如202409）
   - **月产油量(t)**（浮点数）← 注意带单位后缀
3. **数据示例**：

| 井号 | 大油田 | 单元 | 年月 | 月产油量(t) |
|------|--------|------|------|-------------|
| W001 | 油田A | 单元1 | 202409 | 100.5 |
| W002 | 油田A | 单元2 | 202409 | 150.3 |

### SEC数据表要求

1. **文件格式**：.xlsx 或 .xls
2. **必需字段**：
   - 井号（文本）
   - SEC油田（文本）
   - SEC单元（文本）
3. **数据示例**：

| 井号 | SEC油田 | SEC单元 | 是否参评 |
|------|---------|---------|----------|
| W001 | SEC油田A | SEC单元1 | 是 |
| W002 | SEC油田A | SEC单元1 | 是 |

---

## 📌 重要提示

### 字段名称规范

系统已经兼容两种字段名格式：

1. **带单位后缀**（推荐）：`月产油量(t)`
2. **不带单位**（兼容）：`月产油量` - 系统会自动转换

但**强烈建议**使用带单位的格式，这样更清晰明确。

### 常见错误

❌ **错误字段名**：
- `月产油量` （可能被识别，但不推荐）
- `月产油` （错误，不会被识别）
- `产油量(t)` （错误，缺少"月"字）

✅ **正确字段名**：
- `月产油量(t)` （推荐）

---

## 🔍 验证数据

可以使用以下Python代码验证您的Excel文件：

```python
from backend.utils.data_io import DataImportExport

# 测试读取A2表
try:
    df = DataImportExport.read_a2_table('your_file.xlsx')
    print('✅ 文件格式正确！')
    print(f'包含 {len(df)} 行数据')
except Exception as e:
    print(f'❌ 错误: {e}')
```

---

## 📞 需要帮助？

如果遇到问题：

1. **检查字段名**：确保包含 `月产油量(t)` 字段
2. **查看错误信息**：Web界面会显示具体的错误
3. **参考示例文件**：`data/input/` 目录下的示例文件
4. **查看文档**：`前端使用说明.md` 和 `项目说明.md`

---

**更新时间：** 2026-01-10  
**版本：** v1.0
